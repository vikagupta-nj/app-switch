<!DOCTYPE html>
<html>
<head>
  <title>PayPal App Switch Test</title>
  <link rel="manifest" href="/app-switch/.well-known/manifest.webmanifest">
  <style>
    body {
      font-family: sans-serif;
      background: #f2f2f2;
      padding: 50px;
    }
    a, button {
      display: inline-block;
      padding: 15px 25px;
      background-color: #0070ba;
      color: white;
      text-decoration: none;
      border-radius: 6px;
      font-size: 16px;
    }
    a:hover {
      background-color: #003087;
    }
  </style>
</head>
<body>
  <h2>PayPal App Switch - Bridge</h2>
<!--   <p>Click the button below to open Bridge:</p>
  <a href="https://www.braintree.stage.paypal.com/pay/app-switch?token=22E37457WL3865120&ssrt=1755027296615&tokenType=ORDER_ID&appLink=https%3A%2F%2Fpaypal.com%2Fapp-switch-checkout%3FappSwitchEligible%3Dtrue%26token%3D22E37457WL3865120%26tokenType%3DORDER_ID">
    Launch Bridge
  </a> -->

  <a href="https://www.paypal.com/app-switch-checkout?token=22E37457WL3865120&tokenType=ORDER_ID">Open Universal Link</a>

  <p>Open using intent</p>

  <a href="" id="intent-link">Open Universal Link (Intent)</a>

  <p>Simulate user interaction by opening Universal Link by clicking a button with JavaScript</p>

  <a href="/app-switch/bridge-simulate-interaction.html">
    Open Simulated Bridge - Auto Redirect (Simulated User Interaction)
  </a>

  <p>No simulated user interaction, open Universal Link with window.location.assign</p>
  
  <a href="/app-switch/bridge-no-interaction.html">
    Open Simulated Bridge - Auto Redirect (No User Interaction)
  </a>

  <p>Open a page that opens Universal Link using window.opem</p>
  
  <a href="/app-switch/bridge-window-open.html" target="_blank">
    Open Simulated Bridge - window.open
  </a>
  
  <a href="/app-switch/history-change-bridge.html">
    History Change Bridge
  </a>

  <script>
    function getIntentUrl(redirectUrl) {
        const encodedRedirect = redirectUrl.replace(/^https?:\/\//, '');
        const encodedFallback = encodeURIComponent(redirectUrl);
        return `intent://${encodedRedirect}#Intent;scheme=https;package=com.paypal.android.p2pmobile;S.browser_fallback_url=${encodedFallback};end;`;    
    }
    const intentUrl = getIntentUrl('https://paypal.com/app-switch-checkout?ba_token=BA-0BB96931BX4549228')

    document.getElementById('intent-link').href = intentUrl

    document.getElementById('sdk').addEventListener('click', () => {
      const result = window.open('about:blank')

      const button = document.createElement('a')
      button.textContent = 'Open Univsal Link'
      button.id = 'test'
      button.href = 'https://www.paypal.com/app-switch-checkout?token=22E37457WL3865120&tokenType=ORDER_ID'
      const script = document.createElement('script');
      script.textContent = `
        (function() {
          const button = document.getElementById('test');
          if (button) {
          console.log('Clicked!')
            button.click();
          } else {
            console.warn('Button with id "test" not found');
          }
        })();

        // document.getElementById('test').addEventListener('click', () => {
        //   console.log('Called!')
        //   window.location.replace('')
        // })
      `;

      const manifest = document.createElement('link')
      manifest.rel = 'manifest'
      manifest.href='https://www.paypal.com/.well-known/manifest.webmanifest'

      result.document.head.appendChild(manifest)
      
      result.document.documentElement.appendChild(button)
      setTimeout(() => {
        result.document.documentElement.appendChild(script)
      }, 500)

    })
  </script>

    <script>
    document.getElementById('sdk-popup-redirect').addEventListener('click', () => {
      const result = window.open('about:blank', '', '')

      result.location = 'https://vikagupta-nj.github.io/app-switch/popup.html'

      console.log('post message!')
      
      setTimeout(() => {
        result.postMessage('popup')
      }, 1000)
    })
  </script>

  <script>
    document.getElementById('sdk-popup-real-bridge').addEventListener('click', () => {
      const result = window.open('about:blank', '', '')

      result.location = 'https://www.paypal.com/pay/app-switch?token=15624925VR2562944&appLink=https%3A%2F%2Fpaypal.com%2Fapp-switch-checkout%3FappSwitchEligible%3Dtrue%26token%3D15624925VR2562944%26tokenType%3DORDER_ID'
    })
  </script>

  <script>
    document.getElementById('sdk-intent').addEventListener('click', () => {
      const result = window.open('about:blank', '', '')

      result.document.location = 'https://vikagupta-nj.github.io/app-switch/intent.html'
    })
  </script>
</body>
</html>
